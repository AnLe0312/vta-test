CREATE TABLE IF NOT EXISTS prod_source.salesline (
    SALESID String,
    LINENUM UInt16,
    ITEMID String,
    SALESSTATUS UInt8,
    NAME String,
    EXTERNALITEMID String,
    TAXGROUP String,
    QTYORDERED Int64,
    SALESDELIVERNOW Float64,
    REMAINSALESPHYSICAL Float64,
    REMAINSALESFINANCIAL Float64,
    COSTPRICE Float64,
    SALESPRICE Float64,
    CURRENCYCODE String,
    LINEPERCENT Float64,
    LINEDISC Float64,
    LINEAMOUNT Float64,
    CONFIRMEDDLV DateTime,
    RESERVATION Int8,
    SALESGROUP String,
    SALESUNIT String,
    PRICEUNIT Int64,
    PROJTRANSID String,
    INVENTTRANSID String,
    CUSTGROUP String,
    CUSTACCOUNT String,
    SALESQTY Int64,
    SALESMARKUP Float64,
    INVENTDELIVERNOW Int64,
    MULTILNDISC Float64,
    MULTILNPERCENT Float64,
    SALESTYPE UInt8,
    BLOCKED UInt8,
    COMPLETE UInt8,
    REMAININVENTPHYSICAL Int64,
    TRANSACTIONCODE String,
    COUNTYORIGDEST String,
    TAXITEMGROUP String,
    TAXAUTOGENERATED Int64,
    UNDERDELIVERYPCT Int64,
    OVERDELIVERYPCT Int64,
    BARCODE String,
    BARCODETYPE String,
    INVENTREFTRANSID String,
    INVENTREFTYPE UInt8,
    INVENTREFID String,
    INTERCOMPANYORIGIN UInt8,
    ITEMBOMID String,
    ITEMROUTEID String,
    LINEHEADER String,
    SCRAP Int8,
    DLVMODE String,
    INVENTTRANSIDRETURN String,
    PROJCATEGORYID String,
    PROJID String,
    INVENTDIMID String,
    TRANSPORT String,
    STATPROCID String,
    PORT String,
    PROJLINEPROPERTYID String,
    RECEIPTDATEREQUESTED Nullable(DateTime),
    CUSTOMERLINENUM UInt16,
    PACKINGUNITQTY Int64,
    PACKINGUNIT String,
    INTERCOMPANYINVENTTRANSID String,
    REMAININVENTFINANCIAL Int64,
    DELIVERYNAME String,
    DELIVERYTYPE UInt8,
    CUSTOMERREF String,
    PURCHORDERFORMNUM String,
    RECEIPTDATECONFIRMED Nullable(DateTime),
    STATTRIANGULARDEAL Int8,
    SHIPPINGDATEREQUESTED DateTime,
    SHIPPINGDATECONFIRMED Nullable(DateTime),
    ADDRESSREFRECID UInt64,
    ADDRESSREFTABLEID UInt64,
    SERVICEORDERID String,
    ITEMTAGGING Int64,
    CASETAGGING Int64,
    PALLETTAGGING Int64,
    LINEDELIVERYTYPE Int64,
    EINVOICEACCOUNTCODE String,
    SHIPCARRIERID String,
    SHIPCARRIERACCOUNT String,
    SHIPCARRIERDLVTYPE Int64,
    SHIPCARRIERACCOUNTCODE String,
    SALESCATEGORY UInt64,
    DELIVERYDATECONTROLTYPE Int64,
    ACTIVITYNUMBER String,
    LEDGERDIMENSION UInt64,
    RETURNALLOWRESERVATION Int64,
    MATCHINGAGREEMENTLINE UInt64,
    SYSTEMENTRYSOURCE UInt64,
    SYSTEMENTRYCHANGEPOLICY UInt64,
    MANUALENTRYCHANGEPOLICY UInt64,
    ITEMREPLACED Int64,
    RETURNDEADLINE Nullable(DateTime),
    EXPECTEDRETQTY Int64,
    RETURNSTATUS UInt8,
    RETURNARRIVALDATE Nullable(DateTime),
    RETURNCLOSEDDATE Nullable(DateTime),  
    RETURNDISPOSITIONCODEID String,
    DELIVERYPOSTALADDRESS UInt64,
    SHIPCARRIERPOSTALADDRESS UInt64,
    SHIPCARRIERNAME String,
    DEFAULTDIMENSION UInt64,
    SOURCEDOCUMENTLINE UInt64,
    TAXWITHHOLDITEMGROUPHEADING_TH UInt64,
    STOCKEDPRODUCT Int64,
    CUSTOMSNAME_MX String,
    CUSTOMSDOCNUMBER_MX String,
    CUSTOMSDOCDATE_MX Nullable(DateTime),
    PROPERTYNUMBER_MX String,
    ITEMPBAID String,
    REFRETURNINVOICETRANS_W UInt64,
    POSTINGPROFILE_RU String,
    TAXWITHHOLDGROUP String,
    INTRASTATFULFILLMENTDATE_HU Nullable(DateTime),
    ASSETID_RU String,
    STATISTICVALUE_LT Float64,
    CREDITNOTEINTERNALREF_PL UInt64,
    PSAPROJPROPOSALQTY Int64,
    PSAPROJPROPOSALINVENTQTY Int64,
    PDSEXCLUDEFROMREBATE Int8,  
    RETAILVARIANTID String,
    AGREEMENTSKIPAUTOLINK Int8,  
    COUNTRYREGIONNAME_RU String,
    CREDITNOTEREASONCODE UInt64,
    DELIVERYTAXGROUP_BR String,
    DELIVERYTAXITEMGROUP_BR String,
    DLVTERM String,
    INVOICEGTDID_RU String,
    MCRORDERLINE2PRICEHISTORYREF UInt64,
    PDSBATCHATTRIBAUTORES Int64,
    PDSCWEXPECTEDRETQTY Int64,
    PDSCWINVENTDELIVERNOW Int64,
    PDSCWQTY Int64,
    PDSCWREMAININVENTFINANCIAL Int64,
    PDSCWREMAININVENTPHYSICAL Int64,
    PDSITEMREBATEGROUPID String,
    PDSSAMELOT Int64,
    PDSSAMELOTOVERRIDE Int64,
    PRICEAGREEMENTDATE_RU Nullable(DateTime),
    PSACONTRACTLINENUM Int64,
    RETAILBLOCKQTY Int64,
    ORDERLINEREFERENCE_NO String,
    VRTAUTOGIFTCARDENTRY Int64,
    VRTITEMBARCODE String,
    VTVNOTES String,
    VTVCONTRACTDISCPERCENT Float64,
    VTVDISCOUNTRATIO Float64,
    VTVISMANUAL Int64,
    MODIFIEDDATETIME DateTime,
    DEL_MODIFIEDTIME Int64,
    MODIFIEDBY String,
    CREATEDDATETIME DateTime,
    DEL_CREATEDTIME Int64,
    CREATEDBY String,
    DATAAREAID String,
    RECVERSION Int64,
    PARTITION UInt64,
    RECID UInt64,
    VTVECRETAILOFFERID String,
    VTAOFFERID String,
    VTAMPOFFERID String,
    VTA_LINEAMOUNT Float64,
    VTADISCOUNTCOUNPONMKP Float64,
    VTAPRICEDIFFERENCEMKP Float64,
    VTASUBTOTALAX Float64,
    VTASUBTOTALMKP Float64,
    VTADOCUMENTID String,
    VTAPOSHIPMENTID String,
    created_at DateTime,
    updated_at DateTime DEFAULT now(),
    PRIMARY KEY (RECID)
)
ENGINE = ReplacingMergeTree(updated_at)
ORDER BY (RECID, CREATEDDATETIME)
PARTITION BY toYYYYMM(CREATEDDATETIME)
TTL CREATEDDATETIME + INTERVAL 5 YEAR DELETE
SETTINGS index_granularity = 8192