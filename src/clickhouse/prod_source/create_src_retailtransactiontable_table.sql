CREATE TABLE IF NOT EXISTS prod_source.retailtransactiontable (
   INVOICEID	String,
   TRANSACTIONID	String,
   TYPE  UInt16,
   RECEIPTID	String,
   STORE	String,
   TERMINAL	String,
   STAFF	String,
   TRANSDATE   DateTime,
   TRANSTIME	UInt32,
   SHIFT	String,
   SHIFTDATE	Nullable(DateTime),
   WRONGSHIFT  Int64,
   INFOCODEDISCGROUP	String,
   CUSTACCOUNT	String,
   TRANSCODE	Int64,
   SALESPAYMENTDIFFERENCE	Float64,
   NETAMOUNT	Float64,
   COSTAMOUNT	Float64,
   GROSSAMOUNT	Float64,
   PAYMENTAMOUNT	Float64,
   DISCAMOUNT	Float64,
   CUSTDISCAMOUNT	Float64,
   TOTALDISCAMOUNT	Float64,
   NUMBEROFITEMS	Float64,
   AMOUNTTOACCOUNT	Float64,
   ROUNDEDAMOUNT	Float64,
   ENTRYSTATUS	UInt16,
   NUMBEROFINVOICES	Int64,
   NUMBEROFITEMLINES	Int64,
   STATEMENTCODE	String,
   STATEMENTID	String,
   REFUNDRECEIPTID	String,
   INCOMEEXPENSEAMOUNT	Float64,
   TOACCOUNT	Int64,
   NUMBEROFPAYMENTLINES	Int64,
   SALEISRETURNSALE	Int64,
   COUNTER	Int64,
   TIMEWHENTOTALPRESSED	Int64,
   TIMEWHENTRANSCLOSED	Int64,
   CURRENCY	String,
   TRANSTABLEID	Int64,
   OPENDRAWER	Int64,
   REPLICATED	Int64,
   INCLUDEDINSTATISTICS	Int64,
   RETRIEVEDFROMRECEIPTID	String,
   CREATEDONPOSTERMINAL	String,
   POSTASSHIPMENT	Int64,
   ITEMSPOSTED	Int64,
   REPLICATIONCOUNTERFROMORIGIN	Int64,
   SELLTOCONTACTID	String,
   LOYALTYCARDID	String,
   CUSTPURCHASEORDER	String,
   COMMENT_	String,
   SALESORDERAMOUNT	Float64,
   SALESINVOICEAMOUNT	Float64,
   RECEIPTEMAIL	String,
   RECEIPTEMAILSENT	Int64,
   EXCHRATE	Float64,
   SALESORDERID	String,
   BATCHID	UInt64,
   BATCHTERMINALID	String,
   BUSINESSDATE	Nullable(DateTime),
   CHANNEL	UInt64,
   CHANNELREFERENCEID	String,
   CREATEDOFFLINE	Int64,
   DEFAULTDIMENSION	UInt64,
   DESCRIPTION	String,
   DLVMODE	String,
   FISCALDOCUMENTID	String,
   FISCALSERIALID	String,
   INVENTLOCATIONID	String,
   INVENTSITEID	String,
   INVOICECOMMENT	String,
   LOGISTICSPOSTALADDRESS	UInt64,
   LOYALTYDISCAMOUNT_RU	Float64,
   ORIGIN	String,
   RECEIPTDATEREQUESTED	Nullable(DateTime),
   SHIPPINGDATEREQUESTED	Nullable(DateTime),
   SKIPAGGREGATION	Int64,
   TOTALMANUALDISCOUNTAMOUNT	Float64,
   TOTALMANUALDISCOUNTPERCENTAGE	Float64,
   CUSTACCOUNTASYNC	String,
   SUBTYPE	Int64,
   MODIFIEDDATETIME	DateTime,
   DEL_MODIFIEDTIME	Int64,
   MODIFIEDBY	String,
   CREATEDDATETIME	DateTime,
   DEL_CREATEDTIME	String,
   CREATEDBY	String,
   DATAAREAID	String,
   RECVERSION	Int64,
   PARTITION	UInt64,
   RECID	UInt64,
   last_synced_at          DateTime,
   updated_at    DateTime DEFAULT now(),
   PRIMARY KEY (RECID)
)
ENGINE = ReplacingMergeTree(updated_at)
ORDER BY (RECID, TRANSDATE)
PARTITION BY toYYYYMM(TRANSDATE)
TTL TRANSDATE + INTERVAL 5 YEAR DELETE
SETTINGS index_granularity = 8192