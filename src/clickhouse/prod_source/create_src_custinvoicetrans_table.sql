CREATE TABLE IF NOT EXISTS prod_source.custinvoicetrans (
   INVOICEID	String,
   INVOICEDATE	DateTime,
   LINENUM	UInt32,
   INVENTTRANSID	String,
   INVENTREFID	String,
   ITEMID	String,
   EXTERNALITEMID	String,
   NAME	String,
   TAXGROUP	String,
   CURRENCYCODE	String,
   PRICEUNIT	Float64,
   QTY	Int64,
   SALESPRICE	Float64,
   DISCPERCENT	Float64,
   DISCAMOUNT	Float64,
   LINEAMOUNT	Float64,
   SALESGROUP	String,
   QTYPHYSICAL	Int64,
   PARTDELIVERY	Int64,
   REMAIN	Float64,
   SALESID	String,
   SALESUNIT	String,
   SALESMARKUP	Float64,
   COMMISSCALC	Int64,
   COMMISSAMOUNTCUR	Float64,
   TRANSACTIONCODE	String,
   DELIVERYTYPE	UInt32,
   COUNTRYREGIONOFSHIPMENT	String,
   ITEMCODEID	String,
   TAXAUTOGENERATED	Int64,
   TAXITEMGROUP	String,
   TAXAMOUNT	Float64,
   TAXWRITECODE	String,
   MULTILNDISC	Float64,
   MULTILNPERCENT	Float64,
   LINEDISC	Float64,
   LINEPERCENT	Float64,
   ORIGSALESID	String,
   LINEHEADER	String,
   TRANSPORT	String,
   INVENTDIMID	String,
   ORIGCOUNTRYREGIONID	String,
   NUMBERSEQUENCEGROUP	String,
   STATPROCID	String,
   DLVDATE	Nullable(DateTime),
   LINEAMOUNTTAX	Float64,
   PORT	String,
   ASSETID	String,
   CUSTOMERLINENUM	UInt32,
   ASSETBOOKID	String,
   LINEAMOUNTMST	Float64,
   TAXAMOUNTMST	Float64,
   LINEAMOUNTTAXMST	Float64,
   COMMISSAMOUNTMST	Float64,
   SUMLINEDISC	Float64,
   SUMLINEDISCMST	Float64,
   INTERCOMPANYINVENTTRANSID	String,
   OLAPCOSTVALUE	Float64,
   EINVOICEACCOUNTCODE	String,
   RETURNDISPOSITIONCODEID	String,
   STATLINEAMOUNTMST	Float64,
   INTRASTATDISPATCHID	String,
   INVENTQTY	Int64,
   ORIGSTATE	String,
   INVENTREFTYPE	UInt32,
   INVENTREFTRANSID	String,
   WEIGHT	Float64,
   RETURNARRIVALDATE	Nullable(DateTime),
   RETURNCLOSEDDATE	Nullable(DateTime),
   REVERSECHARGEAPPLIES_UK	Int64,
   REASONREFRECID	UInt64,
   REMAINBEFORE	Float64,
   SALESCATEGORY	UInt64,
   CUSTINVOICELINEIDREF	UInt64,
   SOURCEDOCUMENTLINE	UInt64,
   DELIVERYPOSTALADDRESS	UInt64,
   LEDGERDIMENSION	UInt64,
   DEFAULTDIMENSION	UInt64,
   TAXWITHHOLDITEMGROUPHEADING_TH	UInt64,
   STOCKEDPRODUCT	UInt64,
   REVERSEDRECID	UInt64,
   NGPCODESTABLE_FR	UInt64,
   PARENTRECID	UInt64,
   TAXWITHHOLDGROUP_TH	String,
   INTRASTATFULFILLMENTDATE_HU	Nullable(DateTime),
   BILLINGCODE	String,
   MCRDELIVERYNAME	String,
   MCRDLVMODE	String,
   PDSCWQTY	Int64,
   PDSCWQTYPHYSICAL	Int64,
   PDSCWREMAIN	Float64,
   RETAILCATEGORY	UInt64,
   ORDERLINEREFERENCE_NO	String,
   MODIFIEDDATETIME	DateTime,
   CREATEDDATETIME	DateTime,
   DEL_CREATEDTIME	Int64,
   CREATEDBY	String,
   DATAAREAID	String,
   RECVERSION	Int64,
   PARTITION	UInt64,
   RECID	UInt64,
   VRTITEMBARCODE	String,
   VTVCONTRACTDISCPERCENT	Float64,
   VTVDISCOUNTRATIO	Float64,
   VTVTRADEDISCOUNTAMOUNT	Float64,
   last_synced_at               DateTime,
   updated_at      DateTime DEFAULT now(),
   PRIMARY KEY (RECID)
)
ENGINE = ReplacingMergeTree(updated_at)
ORDER BY (RECID, INVOICEDATE)
PARTITION BY toYYYYMM(INVOICEDATE)
TTL INVOICEDATE + INTERVAL 5 YEAR DELETE
SETTINGS index_granularity = 8192