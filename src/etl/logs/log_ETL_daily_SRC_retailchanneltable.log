2025-03-30 13:28:08,879 [INFO] ETL Pipeline started for job: daily_SRC_retailchanneltable
2025-03-30 13:28:10,915 [INFO] Starting Extract
2025-03-30 13:28:11,721 [DEBUG] Making request: POST https://oauth2.googleapis.com/token
2025-03-30 13:28:16,734 [INFO] Extracted 566 records from GCS.
2025-03-30 13:28:16,734 [INFO] Completed Extract in 5.82 seconds, memory used: 20.87 MB, CPU used: 6.20%
2025-03-30 13:28:16,734 [INFO] Starting Transform
2025-03-30 13:28:18,285 [WARNING] Column 'YVS_EINVOICEPOS' is missing from the ClickHouse schema and will be skipped.
2025-03-30 13:28:18,285 [WARNING] Column 'VTAALLOCATIONCLASSIFICATION' is missing from the ClickHouse schema and will be skipped.
2025-03-30 13:28:18,331 [INFO] Transformed 566 records.
2025-03-30 13:28:18,331 [INFO] Completed Transform in 1.60 seconds, memory used: 0.61 MB, CPU used: 4.00%
2025-03-30 13:28:18,332 [INFO] Starting Load
2025-03-30 13:28:18,452 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 13:28:20,030 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 13:28:20,030 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 13:28:20,085 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 13:28:20,093 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 13:28:21,402 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:21,448 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:21,464 [ERROR] Error in Load (Attempt 1/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 75, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:21,470 [WARNING] Retrying Load in 2 seconds...
2025-03-30 13:28:23,608 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 13:28:25,320 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 13:28:25,320 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 13:28:25,370 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 13:28:25,387 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 13:28:25,906 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:25,906 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:25,921 [ERROR] Error in Load (Attempt 2/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 75, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:25,932 [WARNING] Retrying Load in 4 seconds...
2025-03-30 13:28:30,070 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 13:28:31,554 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 13:28:31,554 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 13:28:31,623 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 13:28:31,639 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 13:28:32,049 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:32,049 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:32,068 [ERROR] Error in Load (Attempt 3/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 75, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 13:28:32,076 [CRITICAL] Failed Load after 3 attempts.
2025-03-30 13:28:32,076 [CRITICAL] ETL Pipeline failed for job: daily_SRC_retailchanneltable â€” Error: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 151, in run_etl_pipeline
    load(transformed_data, logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 75, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 62
 Code: 62. DB::Exception: Cannot parse expression of type DateTime here: 0.000000,0.000000,'2025-03-30 13:28:18'),
('None',0.000000,0.000000,0.000000,'None','None','None','CHA074','',32400.000000,75600.000000,2.000000,1.000000,0.0000: While executing ValuesBlockInputFormat. (SYNTAX_ERROR) (version 24.10.1.11464 (official build))

2025-03-30 14:37:01,439 [INFO] ETL Pipeline started for job: daily_SRC_retailchanneltable
2025-03-30 14:37:03,469 [INFO] Starting Extract
2025-03-30 14:37:03,558 [DEBUG] Making request: POST https://oauth2.googleapis.com/token
2025-03-30 14:37:07,742 [INFO] Extracted 566 records from GCS.
2025-03-30 14:37:07,742 [INFO] Completed Extract in 4.27 seconds, memory used: 19.88 MB, CPU used: 14.10%
2025-03-30 14:37:07,742 [INFO] Starting Transform
2025-03-30 14:37:09,502 [WARNING] Column 'YVS_EINVOICEPOS' is missing from the ClickHouse schema and will be skipped.
2025-03-30 14:37:09,502 [WARNING] Column 'VTAALLOCATIONCLASSIFICATION' is missing from the ClickHouse schema and will be skipped.
2025-03-30 14:37:09,575 [INFO] Transformed 566 records.
2025-03-30 14:37:09,575 [INFO] Completed Transform in 1.83 seconds, memory used: 1.89 MB, CPU used: 5.30%
2025-03-30 14:37:09,575 [INFO] Starting Load
2025-03-30 14:37:09,698 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:37:11,342 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:37:11,342 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:37:11,397 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:37:11,397 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:37:12,650 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:12,667 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:12,667 [ERROR] Error in Load (Attempt 1/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:12,681 [WARNING] Retrying Load in 2 seconds...
2025-03-30 14:37:14,793 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:37:16,341 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:37:16,341 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:37:16,409 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:37:16,427 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:37:16,958 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:16,958 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:16,958 [ERROR] Error in Load (Attempt 2/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:16,972 [WARNING] Retrying Load in 4 seconds...
2025-03-30 14:37:21,096 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:37:22,608 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:37:22,608 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:37:22,661 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:37:22,677 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:37:23,095 [ERROR] âŒ Query execution failed: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:23,095 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:23,111 [ERROR] Error in Load (Attempt 3/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:37:23,122 [CRITICAL] Failed Load after 3 attempts.
2025-03-30 14:37:23,122 [CRITICAL] ETL Pipeline failed for job: daily_SRC_retailchanneltable â€” Error: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 151, in run_etl_pipeline
    load(transformed_data, logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 179, in generate_query
    insert_in_batches(new_data_string, client, database_name, table, col_names_str)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 92, in insert_in_batches
    execute_with_retries(batch_insert_query, client)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 69, in execute_with_retries
    client.query(query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 228, in query
    return self._query_with_context(query_context)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 239, in _query_with_context
    response = self._raw_request(body,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 72
 Code: 72. DB::Exception: Cannot read floating point value: Cannot parse Float64 from String: while executing 'FUNCTION if(isNull(-dummy-0) : 3, defaultValueOfTypeName('Float64') :: 2, _CAST(-dummy-0, 'Float64') :: 4) -> if(isNull(-dummy-0), defaultValueOfTypeName('Float64'), _CAST(-dummy-0, 'Float64')) Float64 : 1': While executing ValuesBlockInputFormat. (CANNOT_PARSE_NUMBER) (version 24.10.1.11464 (official build))

2025-03-30 14:47:31,364 [INFO] ETL Pipeline started for job: daily_SRC_retailchanneltable
2025-03-30 14:47:33,388 [INFO] Starting Extract
2025-03-30 14:47:33,461 [DEBUG] Making request: POST https://oauth2.googleapis.com/token
2025-03-30 14:47:37,917 [INFO] Extracted 566 records from GCS.
2025-03-30 14:47:37,917 [INFO] Completed Extract in 4.53 seconds, memory used: 20.49 MB, CPU used: 11.10%
2025-03-30 14:47:37,917 [INFO] Starting Transform
2025-03-30 14:47:39,574 [WARNING] Column 'YVS_EINVOICEPOS' is missing from the ClickHouse schema and will be skipped.
2025-03-30 14:47:39,574 [WARNING] Column 'VTAALLOCATIONCLASSIFICATION' is missing from the ClickHouse schema and will be skipped.
2025-03-30 14:47:39,574 [INFO] Dropped 2 column(s) not in schema: ['YVS_EINVOICEPOS', 'VTAALLOCATIONCLASSIFICATION']
2025-03-30 14:47:39,599 [INFO] Added missing column 'updated_at' with default or null values.
2025-03-30 14:47:39,647 [INFO] Final DataFrame shape after schema transformation: (566, 98)
2025-03-30 14:47:39,647 [INFO] Transformed 566 records.
2025-03-30 14:47:39,647 [INFO] Completed Transform in 1.73 seconds, memory used: 1.13 MB, CPU used: 20.60%
2025-03-30 14:47:39,647 [INFO] Starting Load
2025-03-30 14:47:39,769 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:47:41,408 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:47:41,408 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:47:41,454 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:47:41,470 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:47:50,204 [INFO] âœ… Batch 1/1 inserted successfully in 8.73s
2025-03-30 14:47:50,204 [INFO] âœ… Insert completed: 566 rows in 8.73s
2025-03-30 14:47:50,204 [DEBUG] âš™ï¸ Optimizing table with query: OPTIMIZE TABLE prod_source.retailchanneltable FINAL
2025-03-30 14:47:50,719 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:47:50,729 [ERROR] Error in Load (Attempt 1/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:47:50,740 [WARNING] Retrying Load in 2 seconds...
2025-03-30 14:47:52,883 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:47:54,393 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:47:54,394 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:47:54,457 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:47:54,474 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:48:02,583 [INFO] âœ… Batch 1/1 inserted successfully in 8.11s
2025-03-30 14:48:02,583 [INFO] âœ… Insert completed: 566 rows in 8.11s
2025-03-30 14:48:02,583 [DEBUG] âš™ï¸ Optimizing table with query: OPTIMIZE TABLE prod_source.retailchanneltable FINAL
2025-03-30 14:48:03,100 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:48:03,116 [ERROR] Error in Load (Attempt 2/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:48:03,123 [WARNING] Retrying Load in 4 seconds...
2025-03-30 14:48:07,276 [INFO] Loading 566 records into prod_source.retailchanneltable.
2025-03-30 14:48:08,862 [DEBUG] ðŸ”‘ Primary key for prod_source.retailchanneltable: RECID
2025-03-30 14:48:08,862 [DEBUG] ðŸ“ Parsed data rows count: 566
2025-03-30 14:48:08,948 [DEBUG] âœ”ï¸ Valid rows count: 566
2025-03-30 14:48:08,965 [DEBUG] ðŸš€ Starting batch insert: 566 rows to insert.
2025-03-30 14:48:17,035 [INFO] âœ… Batch 1/1 inserted successfully in 8.07s
2025-03-30 14:48:17,035 [INFO] âœ… Insert completed: 566 rows in 8.07s
2025-03-30 14:48:17,035 [DEBUG] âš™ï¸ Optimizing table with query: OPTIMIZE TABLE prod_source.retailchanneltable FINAL
2025-03-30 14:48:17,749 [ERROR] âŒ Error generating query: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:48:17,749 [ERROR] Error in Load (Attempt 3/3): HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 14:48:17,767 [CRITICAL] Failed Load after 3 attempts.
2025-03-30 14:48:17,769 [CRITICAL] ETL Pipeline failed for job: daily_SRC_retailchanneltable â€” Error: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))
Traceback (most recent call last):
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 151, in run_etl_pipeline
    load(transformed_data, logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\logs\etl_logger.py", line 88, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\daily_ETL_src_retailchanneltable.py", line 78, in load
    query = generate_query(query_type=query_type, database_name=database_name, table=table_name, data=prepared_data, interval='12 DAY', logger=logger)
  File "c:\Users\PC\Work\VTA\GitAn\vta-test\src\etl\modules\generate_query.py", line 184, in generate_query
    client.query(optimize_query)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\client.py", line 221, in query
    response = self.command(query,
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 361, in command
    response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 474, in _raw_request
    self._error_handler(response)
  File "C:\Users\PC\AppData\Local\Programs\Python\Python39\lib\site-packages\clickhouse_connect\driver\httpclient.py", line 395, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://ofvssfn5dd.us-central1.gcp.clickhouse.cloud:8443 received ClickHouse error code 388
 Code: 388. DB::Exception: Cannot run optimize, background pool is already full, try to execute in synchronous mode (alter_sync >= 1). (CANNOT_ASSIGN_OPTIMIZE) (version 24.10.1.11464 (official build))

2025-03-30 15:20:29,815 [INFO] ETL Pipeline started for job: daily_SRC_retailchanneltable
2025-03-30 15:20:31,838 [INFO] Starting Extract
2025-03-30 15:20:31,909 [DEBUG] Making request: POST https://oauth2.googleapis.com/token
2025-03-30 15:20:36,507 [INFO] Skipping processing of raw/RETAILCHANNELTABLE.parquet. The file is not newer than the table.
2025-03-30 15:20:36,507 [INFO] Completed Extract in 4.67 seconds, memory used: 20.19 MB, CPU used: 23.90%
2025-03-30 15:20:37,523 [INFO] ETL Pipeline completed for job: daily_SRC_retailchanneltable in 6.70 seconds, total memory used: 20.20 MB, total CPU used: 23.95%
